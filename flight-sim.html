<!DOCTYPE html>
<html data-bs-theme="dark" lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Flight Simulator</title>
    <link href="css/custom.css" rel="stylesheet">
</head>
<body>

<div class="container-fluid">
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
                    class="navbar-toggler" data-bs-target="#navbarSupportedContent"
                    data-bs-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a aria-current="page" class="nav-link active" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://itch.io/profile/carrotcakevr">Itch.io</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/FeveredCarrot">Github</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mailto:jaspermclean10@gmail.com">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <h1 class="title display-4 text-center p-3">Flight Simulator</h1>
        <div class="row">
            <div class="col"></div>
            <div class="col-xl-12 justify-content-center">
                <video autoplay class="img-fluid m-3" loop muted>
                    <source src="videos/FlightSimPreview.mp4" type="video/mp4">
                </video>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <p class="blog-text">After growing increasingly frustrated with the game "War Thunder" for its predatory
                    pricing
                    model and uninspired gameplay, I decided to try my hand at making my own flight simulator game. I'm
                    still far
                    from finished, but I consider what I have so far to be worthy of sharing regardless.
                </p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <p class="blog-text">
                    My initial goal for the game was to make a generalized flight model that behaves realistically while
                    being simple
                    enough to quickly tune to many different airframes. I ended up implementing parts of a technique I
                    found in a video by
                    <a href="https://youtu.be/p3jDJ9FtTyM">Jump Trajectory</a>. Basically, each wing surface calculates
                    lift and drag forces using these equations:

                </p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <p class="blog-text text-xl-center" style="font-size: 32px">
                    <math class="p-3" xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>L</mi>
                        <mo>=</mo>
                        <msub>
                            <mi>C</mi>
                            <mi>L</mi>
                        </msub>
                        <mfrac>
                            <mrow>
                                <mi>p</mi>
                                <msup>
                                    <mi>v</mi>
                                    <mn>2</mn>
                                </msup>
                            </mrow>
                            <mn>2</mn>
                        </mfrac>
                        <mi>S</mi>
                    </math>
                    <math class="p-3" xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>D</mi>
                        <mo>=</mo>
                        <msub>
                            <mi>C</mi>
                            <mi>D</mi>
                        </msub>
                        <mfrac>
                            <mrow>
                                <mi>p</mi>
                                <msup>
                                    <mi>v</mi>
                                    <mn>2</mn>
                                </msup>
                            </mrow>
                            <mn>2</mn>
                        </mfrac>
                        <mi>S</mi>
                    </math>
                </p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-double-column align-content-center">
                <p class="blog-text">
                    Where:
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>L</mi>
                    </math>
                    = lift
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>D</mi>
                    </math>
                    = drag,
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>p</mi>
                    </math>
                    = air density
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>v</mi>
                    </math>
                    = air velocity (relative to wing)
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <msub>
                            <mi>C</mi>
                            <mi>L</mi>
                        </msub>
                    </math>
                    = coefficient of lift
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <msub>
                            <mi>C</mi>
                            <mi>L</mi>
                        </msub>
                    </math>
                    = coefficient of drag
                </p>
                <p class="blog-text">
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>S</mi>
                    </math>
                    = wing surface area
                </p>
            </div>
            <div class="blog-double-column">
                <figure class="figure">
                    <img alt="images/MediaObj_Placeholder.png" class="img-fluid"
                         src="images/CoefficientCurvePreview.png">
                    <figcaption class="blog-caption">Lift coefficient curve. X-axis is angle of attack.</figcaption>
                </figure>

            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <p class="blog-text">
                    The coefficients of lift and drag are what distinguishes the characteristics of wing surfaces from
                    each other.
                    Angle of attack (the angle between the wing direction and airflow direction) is the main parameter
                    that goes into calculating the coefficients. Generally, as angle of attack increases,
                    lift and drag will also increase until the wing begins to stall and rapidly lose lift.
                </p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <p class="blog-text">
                    In the video, Jump Trajectory also describes a method of
                    dynamically calculating the coefficients of lift and drag for a wing surface, but the formulae used
                    are only valid for rectangular wings in the subsonic regime. Instead, I created the lift/drag
                    coefficient curves
                    manually and stored them each as a Unity <code>AnimationCurve</code> in a
                    <code>ScriptableObject</code>.
                    I based the shape of the coefficient curves on whatever publicly available data I could find on the
                    aircraft, but in the future, I'd like to try finding a solution that is less
                    reliant on test flight/CFD simulation data.
                </p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row justify-content-center">
            <div class="col"></div>
            <div class="blog-center-col">
                <figure class="figure">
                    <img alt="images/MediaObj_Placeholder.png" class="img-fluid"
                         src="images/WingPreview.png">
                    <figcaption class="blog-caption">Wing shape editor.</figcaption>
                </figure>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <p class="blog-text">
                    The wing area is calculated from the position and chord (length) of the base and tip of the wing.
                    The forces are applied to the wing's aerodynamic center, and the effective angle of attack is
                    optionally
                    modified depending on the amount of flap deflection. This behavior is not entirely realistic,
                    but it works well enough for the purposes of the game. When each wing surface is put together on the
                    aircraft, the result is that it flies semi-realistically.
                </p>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-double-column">
                <p class="blog-text">
                    I also wanted the game to be multiplayer, so I used the Photon Fusion 2.0 networking library to
                    synchronize
                    the game state between a host and multiple clients. The Fusion SDK has some convenient features,
                    such
                    as a networked transform component and a lag compensation system. However, the provided network
                    transform
                    component was not a good solution for synchronizing projectiles across the network. When the plane
                    shoots,
                    hundreds of bullets can be instantiated each second, and if the server has to update position data
                    of
                    thousands of projectiles per tick, it quickly eats up all the network bandwidth. To fix this issue,
                    I
                    created a custom data structure that holds the initial position, velocity, and time of the
                    projectile.
                    This is the only data sent over the network; the position of the projectile each tick is
                    extrapolated
                    from pre-calculated tables of the distance over time for each initial velocity.
                </p>
            </div>
            <div class="blog-double-column p-3">
                <figure class="figure">
                    <img alt="images/MediaObj_Placeholder.png" class="img-fluid"
                         src="images/BallisticsPreview.png">
                    <figcaption class="blog-caption">Pre-computed distance/time tables.</figcaption>
                </figure>

            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="blog-center-col">
                <figure class="figure">
                    <img alt="images/MediaObj_Placeholder.png" class="img-fluid"
                         src="images/NetworkProjectilePreview.png">
                    <figcaption class="blog-caption">Network Projectile data structure.</figcaption>
                </figure>
            </div>
            <div class="col"></div>
        </div>
    </div>
</div>
<footer class="footer-pad m-5"></footer>
<script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>